################################################################################
#              DO NOT EDIT THIS FILE (Auto-Generated) - COPY IT!               #
#                                                                              #
# Contents of this file were generated by https://github.com/parcelLab/.github #
# Changes to this file may be overwritten.                                     #
#                                                                              #
# Copy this file into the repo .github/workflows folder and edit it based on   #
# your needs to create a new workflow. Rename it to `test.yaml`.               #
################################################################################
name: Test
on:
  push:
    branches:
      - main
    paths:
      - "**.js"
      - "**.ts"
      - "**.pegjs"
      - Containerfile
      - package.json
  pull_request:
    paths:
      - "**.js"
      - "**.ts"
      - "**.pegjs"
      - Containerfile
      - package.json
  workflow_dispatch:
jobs:
  test:
    uses: ./.github/workflows/_js.yaml
    secrets: inherit
  draft:
    if: github.ref == 'refs/heads/main'
    needs:
      - test
    uses: ./.github/workflows/_release.yaml
    secrets: inherit
  staging:
    if: github.ref == 'refs/heads/main'
    needs:
      - test
    uses: ./.github/workflows/_deployment-trigger.yaml
    with:
      author: ${{ github.event.pusher.name }}
      description: ${{ toJSON(github.event.head_commit.message) }}
      env: staging
      ref: ${{ github.ref }}
    secrets: inherit
